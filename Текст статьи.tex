\documentclass[draft, 12pt]{article}
\usepackage[cp1251]{inputenc} % следующие две строки используются для
\usepackage[english,russian]{babel}   % руссификации AmSLaTeX
\usepackage{amsmath,amsfonts,amssymb,euscript,graphicx,wrapfig,multirow}
\usepackage{dsfont}
\textheight=240mm \textwidth=170mm
\hoffset=-17mm % сдвиг влево
\voffset=-17mm % сдвиг вверх

\begin{document}

\noindent УДК 517.925.7

\begin{center}
\textbf{О численном методе решения семейства интегро-дифференциальных уравнений с переменными коэффициентами, возникающих в финансовой математике} \\[3mm]
\textbf{О.~Е.~Кудрявцев}\\[2mm]
\emph{Ростовский филиал Российской таможенной академии}

\textbf{В.~В.~Родоченко}\\[2mm]
\emph{Южный Федеральный Университет}
\end{center}

\hyphenation{дифферен-циаль-ных дифферен-циаль-ные дифферен-циаль-ное}

\section{Аннотация}
Мы представляем новый численный метод решения семейства интегро-дифференциаль-ных уравнений с переменными коэффициентами, возникающих при вычислении стоимости барьерного опциона для широкого класса популярных моделей со скачками и стохастической волатильностью, вариация в которых подчиняется процессу CIR. Мы используем подходящие замены переменных для устранения эффекта корреляции, приближаем процесс вариации на малых отрезках времени при помощи специальным образом построенной марковской цепи, а затем в каждом из узлов цепи решаем задачи вычисления цены барьерного опциона при помощи метода линий. Для решения полученных задач используется авторский метод быстрой приближённой факторизации Винера-Хопфа. Итоговый ответ получаем при помощи рекуррентной процедуры, движущейся назад во времени по дереву вариации.

\section{Введение}


Со времен фундаментальных работ Е. Б. Дынкина, Р. Фейнмана и М. Каца известно, что решение уравнения диффузии в определенной области может быть интерпретировано как математическое ожидание выхода из нее винеровского процесса. В дальнейших исследованиях эта взаимосвязь была распространена, в частности, на процессы, комбинирующие диффузионную модель и модель Леви, траектории которых могут быть разрывными. В настоящее время процессы Леви используются при моделировании различных естественных и экономических явлений и привлекают внимание как исследователей, так и финансовых институтов. С точки зрения приложений в сфере финансовой математики, разработка инструментов для решения этих уравнений позволяет решать одну из важных прикладных задач -- задачу вычисления цен производных финансовых инструментов, в частности -- опционов.

Таким образом, вычисление функционалов от марковских процессов со скачками является важным и актуальным для приложений направлением исследования. Указанная задача является нетривиальной и сводится к решению достаточно сложных интегро-диффе-ренциальных уравнений с частными производными, известных как прямое и обратное уравнение Колмогорова, с определенными начальными и краевыми условиями. Как правило, аналитические методы непригодны для решения подобных уравнений, поэтому возникает необходимость привлечения современного аппарата вычислительной математики. 

В качестве базовой модели рассмотрим систему стохастических дифференциальных уравнений, записанную в форме Ито, которая описывает динамику положения $S_t$ частицы на прямой во взаимосвязи с процессом вариации $V_t$, которая подчиняется процессу CIR [CIR]. 
\begin{equation}
\begin{array}{l}
dS_t = (r-\lambda_J \zeta)S_t dt+\sqrt{V_t} S_t dZ^S_t+(J-1) S_t dN_t,
\smallskip\\
dV_t= \kappa_V(\theta_V-V_t)dt+\sigma_V\sqrt{V_t}dZ^V_t,
\smallskip\\
<dZ^S_t,dZ^V_t> = \rho dt,
\smallskip\\
\end{array}
\end{equation}
где $r$ -- неотрицательный параметр, $Z^S_t$ и $Z^V_t$ - винеровские процессы, связанные коэффициентом корреляции $\rho$. В скачковой части, $N_t$ представляет из себя пуассоновский процесс с интенсивностью $\lambda_J$, считающий к моменту $t$ количество одинаково распределенных скачков размера $J$. Процесс $N_t$ не зависит от процессов $Z^S_t$ и $Z^V_t$, а также независим от $J$.  Параметр $\kappa_V$ определяет скорость ``возврата'' процесса вариации к ``долговременному'' среднему значению $\theta_V$, $\sigma_V>0$ называется ``волатильностью'' вариации. Соотношение между  $\zeta$ и параметрами распределения $J$ подбирается из соображения мартингальности процесса $\exp(-rt)S_t$. 

В финансовых приложениях процесс $S_t$ в (1) моделирует динамику цены финансового актива, а параметр $r \ge 0$ имеет смысл безрисковой процентной ставки. Если величина скачков $J$ имеет логнормальное распределение $J\sim \mbox{LogN}(\mu_J, \sigma_J^2)$, тогда $\zeta = e^{\mu_J + \frac{1}{2}\sigma_J^2} - 1$ и мы получаем ``модель Бейтса'', описанную в работе [Bates]. В случае, если положить интенсивность скачков равной нулю, сохраняя динамику процесса вариации, система выродится в систему уравнений модели Хестона -- одну из наиболее известных моделей со стохастической волатильностью [Heston].

Если заменить процесс $V_t$ положительной постоянной $V_0$, то первое уравнение системы (1) будет описывать процесс Леви, известный в литературе как диффузия со скачками (англ. jump-diffusion), см. например, [Cont, Tankov]. В частности, если $J$ имеет логнормальное распределение, то мы получем модель Мертона [Merton], а если положить интенсивность скачков равной нулю, модель сведётся к одной из наиболее исследованных и известных моделей финансового рынка -- модели Блэка-Шоулза [B-S].

%Описываемый метод позволяет охватить семейство моделей с различным образом распределёнными скачками, из семейства регулярных процессов Леви экспоненциального типа. Описание ограничений, накладываемых на вид процесса цены, при фиксированной вариации, можно найти в работе [Кудрявцев, Мекс.].
Целью работы является разработка универсального численного метода вычисления условного математического ожидания 
\begin{equation}
f(S,V,t) = M[e^{-r(T-t)}  {\bf 1}_{\underline{S}_T>H} G(S_T) | S_t = S, V_t = V],
\end{equation}
для моделей вида (1), где $H$ -- поглощающий барьер, $\underline{S}_T (= \inf_{0\le t\le T}S_T)$ -- процесс инфимума процесса $S_t$. 

Функционалы вида (2) возникают в финансовой математике при решении задачи о нахождении цены барьерного опциона в модели (1). Под ``барьерным опционом'' мы будем понимать контракт, по которому выплачивается определённая сумма $G(S_T)$ в момент окончания срока действия контракта $T$, при условии, что в течение срока действия контракта цена актива $S_T$ не упадёт ниже определённого барьера $H$ (down-and-out barrier option) или не поднимется выше определённого барьера $H$ (up-and-out barrier option). Например, для опциона, дающего право продать базовый актив по цене $K$ (``опцион put''), $G(S)=\max\{0, K - S\}$, а для опциона, дающего право купить базовый актив по цене $K$ (``опцион call''), $G(S)=\max\{0, S - K\}$.

Пусть $\tau = T-t$, тогда $F(S,V,\tau)\left(=f(S,V, T-\tau)\right)$ удовлетворяет следующему [см, например, статья 17 Фенг]) интегро-дифференциальному уравнению в частных производных с переменными коэффициентами в области $S(\tau) > H$.
\begin{eqnarray*}
		\frac{\partial F(S,V,\tau)}{\partial \tau} &= &
		\frac{1}{2} VS^2 \frac{\partial^2 F(S,V,\tau)}{\partial S^2} +
		\rho\sigma_V VS \frac{\partial^2 F(S,V,\tau)}{\partial S \partial V} +
		\\
		\frac{1}{2} \sigma_V^2 V \frac{\partial^2 F(S,V,\tau)}{\partial V^2} &+&
		(r - \lambda_J \zeta) S \frac{\partial F(S,V,\tau)}{\partial S} +
		\kappa_V(\theta_V - V) \frac{\partial F(S,V,\tau)}{\partial V} - 
		\\
		(r+\lambda_J)F(S,V,\tau) &+&
		\lambda_J \int_0^\infty F(JS,V,\tau) f(J) dJ,
		\\
		F(S,V,0) &=& G(S),
\end{eqnarray*}
где $f(J)$ - функция плотности вероятностей величины скачков $J$. Поскольку $H$ является поглощающим барьером и $S_t$ может перескакивать через барьер, то необходимо добавить условие $F(S,V,\tau) = 0,  S(\tau) \le H$.

Основными подходами к решению таких уравнений являются метод Монте-Карло (Alfonsi, A. High order discretization schemes for the CIR process: application to affine term structure and Heston models (2010)), конечно-разностные схемы (см. Chiarella, C. et. al., The Evaluation of Barrier Option Prices Under Stochastic Volatility (2010)) и гибридный подход, комбинирующий метод деревьев и конечно-разностные схемы (Briani, D.M. et. al., A hybrid tree-finite difference approach for the Heston model (2014)).

Наиболее серьезным недостатком методов Монте-Карло является низкая скорость вычислений, поскольку в случае задач с барьерами в моделях со скачками возникает необходимость детального моделирования траектории. Конечно-разностные схемы зависят от конкретной модели Леви и недостаточно точны, поскольку соответствующая матрица системы в отличие от диффузионных моделей является плотной, а для ее обращения многие авторы в неявном виде используют только трехдиагональную часть. 
Ряд авторов комбинируют метод расщепления и конечно-разностные схемы, аппроксимируя интегральную часть как функцию символа соответствующего псевдодифференциального оператора от конечных разностей (Itkin, A. Pricing Derivatives Under Levy Models (2017)), но для популярных моделей Леви это приводит к необходимости вычислять матричные логарифмы и экспоненты, что может приводить к существенным вычислительным погрешностям.

С целью снижения размерности уравнения ряд авторов (см., напр., [Ch1, Briani, D.M. et. al.]) предлагают использовать марковскую цепь с непрерывным временем для аппроксимации процесса волатильности, простейшим случаем которой является биномиальной модель [Appol]. В результате, мы получаем модель Леви с переключением режимов по волатильности. Марковская цепь с непрерывным временем строится так, чтобы вероятности перехода из каждого состояния сохраняли соответствующие мгновенные снос и/или волатильность. 

В серии статей (см., например, [KuLev, KuОбозрение, KuMathMod, KuZanet]) универсальный метод приближенной факторизации Винера-Хопфа для широкого класса процессов Леви с фиксированной вариацией был применен для решения задач с барьерами для интегро-дифференциальных уравнений, к которым сводится вычисление цен различных видов опционов.  Численная реализация операторов Винера-Хопфа осуществлялась с помощью быстрого преобразования Фурье, что делало соответствующие методы вычисления цен опционов по простоте реализации близкими к конечно-разностным схемам, но, как показывают численные эксперименты [KuLev, KuZanet], значительно более быстрыми и точными. 

В основе нового предлагаемого численного метода решения задачи (2) будет лежать новая усовершенствованная приближенная факторизация Винера-Хопфа, разработанная в [Advantages of the Laplace transform approach in pricing first touch digital options in Levy-driven models (2016)]. Новые формулы являются более универсальными по сравнению с [KuL], поскольку не требуют выделения главной части факторизуемой характеристической функции. Для решения поставленной задачи после дискретизации по времени (метод линий) коэффициенты полученного интегро-дифференциального оператора будет аппроксимироваться с помощью метода деревьев, моделирующего процесс волатильности, тем самым сводя задачу в каждом узле дерева к модели с постоянной волатильностью, а для соответствующей задачи будут использованы новые явные формулы для факторов Винера-Хопфа.  В результате, мы получим метод сравнимый по скорости с гибридной конечно-разностной схемой, но более универсальный и точный.


\section{Замена процесса}

Одним из свойств модели является эффект корреляции винеровских процессов в уравнениях для цены и вариации. Для решения уравнений его необходимо учесть при построении процедуры оценки. Методика, которой мы воспользуемся, аналогична применяемой в [Zanet, Деревья], и состоит в том, чтобы подобрать подходящую замену для процессов. Обозначим $\hat{\rho} = \sqrt{1-\rho^2}$, $W = Z^V$, $\rho W + \hat{\rho}Z = Z^S$, где $W_t$ $Z_t$ - независимые броуновские движения. В этих терминах мы получаем возможность переписать систему (1).

Введём также замену для процесса $S_t$, положив $Y_t = \ln(\frac{S_t}{H}) - \frac{\rho}{\sigma_V}V_t$. При этом $S_t = H\exp(Y_t + \frac{\rho}{\sigma_V}V_t) $  Такой вид замены одновременно позволяет перейти к логарифмической шкале и произвести нормировку по отношению к барьеру, которая является удобной с вычислительной точки зрения.
После введения обеих замен, система (1) примет вид:

\begin{equation}
\begin{array}{l}
d Y_t = (r-\frac{1}{2}V_t - \frac{\rho}{\sigma_V}\kappa_V(\theta_V - V_t) - \lambda_J \zeta)dt+\hat{\rho}\sqrt{V_t} dZ_t+\ln JdN_t,
\smallskip\\
dV_t= \kappa_V(\theta_V-V_t)dt+\sigma_V\sqrt{V_t}dW_t.
\smallskip\\
\end{array}
\end{equation}

Для дальнейшего описания алгоритма введём следующие обозначения:

\begin{equation*}
\begin{array}{l}
\mu_Y(V_t) = r - \frac{1}{2}V_t - \frac{\rho}{\sigma_V}\kappa_V(\theta_V - V_t)  - \lambda_J \zeta,
\smallskip\\
\mu_V(V_t) = \kappa_V(\theta_V - V_t).
\smallskip\\
\end{array}
\end{equation*}

\section{Рандомизация Карра}
Для того, чтобы иметь возможность свести рассматриваемую задачу к задаче на малых интервалах времени, мы используем процедуру, известную как <<рандомизация Карра>>, впервые введённую в статье [Карр, рандомизация] и обобщённую на общий случай задач стохастического управления в статье [Карр, обобщение]. Обозначим $F_{n}({Y}_{t_n}, {V}_{t_n}) = F_{n}(H\exp(Y_t + \frac{\rho}{\sigma_V}V_t), {V}_{t_n}, t_n)$ - приближение Карра значения функции $F(S,V,\tau)$ в момент времени $t_n$, где $t_i = i \Delta \tau$ и $\Delta \tau = \frac{T}{N}$. Пусть $\{\tau_i\}_{i=1}^N$ –- набор независимых экспоненциально распределённых случайных величин со средним $\Delta \tau$. Обозначим $Z_\tau^n=Y_{t_n + \tau}+\frac{\rho}{\sigma_V}V_{t_n + \tau}$.

Полагая $F_{N}(Y_T, V_T)=G(H\exp (Y_T+\frac{\rho}{\sigma_V}V_T ))$, получаем возможность записать:

$$
F_{n}({Y}_{t_n}, {V}_{t_n}) = M_{t_{n}} [ e^{-r\Delta \tau}  
I_{\underline{Z}^n_{\tau_n} > 0} F_{n+1}(Y_{t_n+\tau_n},V_{t_n+\tau_n})], \smallskip\\ n = N-1,..,0 
$$

\section{Аппроксимация}

Нашей следующей целью является свести полученную задачу к семейству задач меньшей размерности и получить модель Леви с переключение режимов по волатильности . Для этого мы построим, следуя процедуре [Антонино, деревья], аппроксимацию процесса CIR при помощи марковской цепи. К её достоинствам можно отнести быструю сходимость к оригинальному процессу и способность сохранять адекватность в широком диапазоне изменения параметров. В частности, условие Феллера $2\kappa_V\theta_V>\sigma_V^2r$ в этом случае не является существенным для корректной работы.

Разделим промежуток $[0, T]$ на N равных частей, $\Delta \tau = \frac{T}{N}$. Зафиксируем точки $t_n = n \cdot \Delta \tau$. Построим  биномиальное дерево со <<склеенными>> вершинами, определяемыми по формуле:
\begin{equation*}	
V(n,k) = (\sqrt{V_0} + \frac{\sigma_V}{2}(2k-n)\sqrt{\Delta \tau})^2 \mathds{1}_{(\sqrt{V_0} + \frac{\sigma_V}{2}(2k-n)\sqrt{\Delta \tau}) > 0}, 
\\ n = 0,1,...,N, \; k = 0,1,...,n.
\end{equation*}

Идея приближения состоит в том, что в каждый момент времени $t_n$ вариация может находиться в одном из состояний $V(n,k)$. В момент $t_{n+1}$ из вершины $(n,k)$ мы можем попасть либо "вверх" - в вершину $(n+1,k_u)$, либо "вниз - вершину $(n+1,k_d)$, при этом $k_u$ и $k_d$ подбираются так, чтобы согласовать движение по дереву со сносом $\mu(V_{(n,k)})$, по следующим правилам:
\begin{eqnarray*}
	k_u^{\Delta \tau}(n,k) = min\{{k^\ast} : k + 1 \le k^\ast \le n + 1, V(n,k) + \mu_{V}(V(n,k)){\Delta \tau} \le V(n+1,k^\ast)\} \\
	k_d^{\Delta \tau}(n,k) = max\{{k^\ast} : 0 \le k^\ast \le k, V(n,k) + \mu_{V}(V(n,k)) \ge V(n+1,k^\ast)\}
\end{eqnarray*}

Определим вероятности переходов следующим образом:

$$
p^{\Delta \tau}_{k^{\Delta \tau}_{u}(n,k)} = 
\frac{\mu_{V}(V(n,k))\Delta \tau+V(n,k)-V(n+1,k^{\Delta \tau}_{d}(n,k))}{V(n+1,k^{\Delta \tau}_{u}(n,k))-V(n+1,k^{\Delta \tau}_{d}(n,k))}
$$

Чтобы обеспечить корректную работу схемы в случае различных значений параметров, необходимо ввести дополнительные правила, предотвращающие появление отрицательных вероятностей в некоторых вершинах:
\begin{equation*}
p^{\Delta \tau}_{k^{\Delta \tau}_{u}(n,k)} :=
\begin{cases}
1, & p^{\Delta \tau}_{k^{\Delta \tau}_{u}(n,k)} > 1\\
p^{\Delta \tau}_{k^{\Delta \tau}_{u}(n,k)}, & p^{\Delta \tau}_{k^{\Delta \tau}_{u}(n,k)} \in [0, 1]\\
0, & p^{\Delta \tau}_{k^{\Delta \tau}_{u}(n,k)} < 0
\end{cases}
, \;\;\;\; p^{\Delta \tau}_{k^{\Delta \tau}_{d}(n,k)} := 1 - p^{\Delta \tau}_{k^{\Delta \tau}_{u}(n,k)},
\end{equation*}

\section{Приближённая факторизация}

Зафиксировав таким образом вариацию в каждом из узлов, мы имеем возможность рассматривать семейство задач с интегро-дифференциальным оператором следующего вида:

$$L_{n,k}f(y) := L_{Y}^{V(n,k)}f(y) = \frac{1}{2\pi}\int^\infty_{-\infty}e^{iy\xi}\psi_{n,k}(\xi)\hat{f}(\xi)d\xi$$

Этот оператор можно понимать как псевдодифференциальный оператор, символом которого является $\psi_{n,k}(\xi)$ -- характеристическая экспонента процесса $Y_t$ при $V_t = V(n,k)$:

\begin{equation}
	\psi_{n,k}(\xi) = \hat{\rho}^2\frac{V(n,k)}{2}\xi^2 - i\mu_Y(V(n,k))\xi + \phi(\xi),
\end{equation}
где $\phi(\xi)$ - слагаемое, зависящее распределения скачков. Например, для модели Мертона оно имеет вид: $\phi(\xi) = -i\lambda(1-e^{\frac{\sigma_J^2}{2} + \mu_J})\xi + \lambda(1-e^{\frac{\sigma_J^2}{2} + \mu_J})$

Для каждого из узлов $(n,k), n=N-1,...0$ возникает две задачи -- одна в предположении, что переход был совершён в вершину $(n+1,k_d)$, другая -- в предположении, что переход был совершён в вершину $(n+1,k_u)$. Решение каждой из этих задач может быть записано в терминах операторов $\varepsilon^{+}_{q}$ и $\varepsilon^{-}_{q}$ - факторов Винера-Хопфа:

\begin{eqnarray}\label{whpf}
f_{n}^{k_{d}}(y) = (q{\Delta \tau})^{-1} \; \varepsilon^{-}_{q} \mathds{1}_{(- \frac{\rho}{\sigma_V}V(n,k), +\infty)}(y) \; \varepsilon^{+}_{q} f_{n+1}^{k_d}(y);\\
f_{n}^{k_{u}}(y) = (q{\Delta \tau})^{-1} \; \varepsilon^{-}_{q} \mathds{1}_{(- \frac{\rho}{\sigma_V}V(n,k), +\infty)}(y) \; \varepsilon^{+}_{q} f_{n+1}^{k_u}(y),
\end{eqnarray}

Далее последовательно вычисляя $f_n^k = p_{k_d^{\Delta \tau}(n,k)} f_n^{k_d}(y) + p_{k_u^{\Delta \tau}(n,k)} f_n^{k_u}(y)$ для $n=N-1,..,0, k = 0,...,n,$
где $f_n^k = F(He^{y+\frac{\rho}{\sigma_V}V(n,k)}, V(n,k), n\Delta \tau)$, мы, после возвращения к исходным обозначениям, получаем приближённые значения искомого функционала (2). В отличие от более простого случая модели Хестона [hikari, мы], наличие скачков лишает возможности использовать явные формулы для факторов - их получить не удаётся. Получение приближённых формул для этих объектов является трудной задачей, последние успехи в которой (см. [см. Мекс, 2016]) позволяют обобщение на случай семейства моделей с различным образом распределёнными скачками.

Приближённые формулы имеют вид:

\begin{eqnarray*}
	\phi^+_q(\xi)&=&\exp\left[(2\pi i)^{-1}
	\int_{-\infty+i\omega_-}^{+\infty+i\omega_-}\frac{\xi\ln(q+\psi(\eta))}
	{\eta(\xi-\eta)}d\eta\right];\\\label{whme1}
	\phi^-_q(\xi)&=&\exp\left[-(2\pi i)^{-1}
	\int_{-\infty+i\omega_+}^{+\infty+i\omega_+}\frac{\xi\ln(q+\psi(\eta))}
	{\eta(\xi-\eta)}d\eta\right],
\end{eqnarray*}

Константы $\omega_+$ и $\omega_-$, такие, что $\omega_-<0<\omega_+$, имеют здесь смысл параметров и подбираются так, чтобы сохранить сходимость соответствующих интегралов и зависят от параметров процесса Леви. Вопросы выбора констант подробнее освещается в статье [Кудрявцев, Мекс]. Свойства этих функций позволяют получить удобное для численной реализации представление. Функция $\phi^+_q(\xi)$ допускает аналитическое продолжение в полуплоскость $\Im \xi>\omega_-$ и может быть представлена как:
\begin{eqnarray}
	\phi^+_q(\xi)&=&\exp\left[i\xi F^+(0)-\xi^2\hat{F}^+(\xi)\right],\\\label{whpn2} 
	F^+(x)&=&\mathds{1}_{(-\infty,0]}(x)(2\pi)^{-1}
	\int_{-\infty+i\omega_-}^{+\infty+i\omega_-}e^{ix\eta}\frac{\ln(q+\psi(\eta))}
	{\eta^2}d\eta;
	\\
	\label{whpn3} \hat{F}^+(\xi)&=&\int_{-\infty}^{+\infty}e^{-ix\xi}F^+(x)dx.
\end{eqnarray}

Аналогично, $\phi^-_q(\xi)$ допускает аналитическое продолжение в полуплоскость $\Im \xi<\omega_+$ и может быть представлена как:
\begin{eqnarray}\label{whmn1}
	\phi^-_q(\xi)&=&\exp\left[-i\xi F^-(0)-\xi^2\hat{F}^-(\xi)\right],\\
	F^-(x)&=&\mathds{1}_{[0,+\infty)}(x)(2\pi)^{-1}
	\int_{-\infty+i\omega_+}^{+\infty+i\omega_+}e^{ix\eta}\frac{\ln(q+\psi(\eta))}
	{\eta^2}d\eta;\\
	\label{whmn3} \hat{F}^-(\xi)&=&\int_{-\infty}^{+\infty}e^{-ix\xi}F^-(x)dx.
\end{eqnarray}

Для вычисления интегралов используется алгоритм быстрого преобразования Фурье.

\section{Выводы}
Получен универсальный метод приближённого решения интегро-дифференциального уравнения с переменными коэффициентами, основанный на применении быстрой приближённой факторизации Винера-Хопфа сохраняющий работоспособность в широком диапазоне изменения параметров.
Метод позволяет вычислять значения функционалов вида (2), для семейства моделей, основанных на широком классе процессов Леви с различным образом распределёнными скачками и имеет ряд приложений в области вычислительной финансовой математики.

Работа выполнена при  поддержке РФФИ (проект 15-32-01390).

%
%The existing literature on numerical schemes for the option pricing problem in this framework is quite poor. Tree methods are available only for the Heston model, see \cite{VN},  but they are not really efficient when the Feller condition does not hold. Another approach is given by the dicretization of partial differential problems.
%When the jumps are not considered, namely for the Heston and the Heston-Hull-White models, disposable references are widely recalled in \cite{bcz, bcz-hhw}. In the standard Bates model, that is, presence of jumps but no randomness in the interest rate, the finite-difference methods for solving the $2$-dimensional PIDE associated with the option pricing problems can be based on implicit, explicit or alternating direction implicit schemes. The implicit scheme requires to solve a dense sparse system at each time step. Toivanen \cite{t} proposes a componentwise splitting method for pricing American options. The linear
%complementarity problem (LCP) linked to the American option problem is
%decomposed into a sequence of five  one-dimensional LCP's problems at
%each time step. The advantage is that LCP's need the use of
%tridiagonal matrices. Chiarella \textit{et al.} \cite{ckmz}
%developed a method of lines algorithm for pricing and hedging American
%options again under the standard Bates dynamics.
%More recently Itkin \cite{it}  proposes a unified approach to handle PIDE's associated with L\'evy's models of interest in Finance, by solving the diffusion equation with standard finite-difference methods and by transforming the jump integral into a pseudo-differential operator. But to our knowledge, no deterministic numerical methods are available in the literature for the Bates-Hull-White model, that is, when the the interest rate is assumed to be stochastic.
%
%From the simulation point of view, the main problem consists in the treatment of the CIR dynamics for the volatility process. It is well known that the standard Euler-Maruyama discretization does not work in this framework. As far as we know, the most accurate simulation schemes for the CIR process have been introduced by Alfonsi \cite{al}. Other methods are available in the literature, see e.g. \cite{andersen}, but in this paper the Alfonsi technique is the one we compare with. In fact, in our numerical experiments we also apply a hybrid Monte Carlo technique: we couple the simulation of the approximating tree for the volatility and the interest rate components with a standard simulation of the underlying asset price, which uses Brownian increments and a straightforward treatment of the jumps. In the case of American option, this is associated with the Longstaff and Schwartz algorithm \cite{ls}, allowing to treat the dynamic programming principle.
%
%As already observed in \cite{bcz,bcz-hhw}, roughly speaking  our methods consist in the application of the most efficient method whenever this is possible: a recombining binomial tree for the volatility and the interest rate, a standard PIDE approach or a standard simulation technique in the direction of the asset price. The results of the numerical tests again support the accuracy of our hybrid methods and besides, we also justify the good behavior of the methods from the theoretical point of view.


%Общие требования
%
%1. Номера формул указываются справа в круглых скобках.
%
%2. Рисунки и таблицы нумеруются. Заголовки рисунков и таблиц должны быть краткими, однако не содержать сокращений.
%
%3. Заголовок рисунка располагается под рисунком по центру, заголовок таблицы располагается над таблицей с правой стороны.
%
%4. Рисунки должны быть хорошего качества и представлены дополнительно отдельными файлами в формате *.eps или *.tif. (и для файлов, набранных в Latex, и для файлов, набранных в Word). Подрисуночные подписи не должны быть включены в рисунок.
%
%5. В тексте статьи ссылки на рисунки, таблицы должны быть оформлены, например, следующим образом:
%... анимация движения двойного математического маятника  представлена на рис. 1 или (см. рис. 1)
%... результаты расчетов представлены в табл. 1
%Не желательно оформлять ссылки "... результаты расчетов представлены ниже", так как при верстке таблицы, рисунки могут быть смещены, например, в нижнюю часть страницы.  
%
%6. При наборе текста следует различать дефисы и тире (рекомендуется использовать короткое тире).
%

% оформление рисунков
%\begin{figure}[h!]
%\begin{center}
%\includegraphics[width=0.75\textwidth]{Ivanov_Petrov_pic_1.eps}\\
%\emph{Рис. 1. }\end{center}
%\end{figure}
%
%\begin{wrapfigure}{R}{5.0cm}
%\begin{center}
%\includegraphics[width=4.5cm, height=4.5cm]{Ivanov_Petrov_pic_1.eps}\\
%\emph{Рис. 1.}\end{center}
%\end{wrapfigure}
%
%% оформление перечней
%\begin{itemize}
%\setlength{\itemsep}{-1mm}
%  \item
%  \item
%  \item
%\end{itemize}

\bigskip\centerline{\bf Литература}

\begin{enumerate}
    \item
	\textsc{E. Appolloni, L. Caramellino, A. Zanette} A robust tree method for pricing American options with CIR stochastic interest rate. 2013
\item
\emph{Bates, D. S.} Jumps and Stochastic Volatility: Exchange Rate Processes Implicit in Deutshe Mark Options / D.~S.~Bates // Review of Financial Studies. –- 1996. -– Vol. 9. –- P.~69–107.
	\item
	\textsc{M. Briani, L. Caramellino, A. Zanette} A hybrid tree-finite difference approach for the Heston model. 2014.
	
	\item
	\emph{Cox, J. C.} A Theory of the Term Structure of Interest Rates / J.~C.~Cox, J.~E.~Ingersoll, S.~A.~Ross // Econometrica. -– 1985. -– Vol. 53. –- P.~385-408.
	\item{Ch2}
\emph{Chourdakis, K.} Levy processes driven by stochastic volatility / K.Chourdakis // Asia-Pacific Finan. Markets. -- 2005. - № 12. -- P.~333-352.
	\item
	\textsc{L. Heston} A Closed-Form Solution for Options with Stochastic Volatility with Applications to Bond and Currency Options. Review of Financial Studies. 1993. v.~6. p.~327--343.
	\item
	\emph{Kudryavtsev, O.} Fast and accurate pricing of barrier options under L\'evy processes / O. Kudryavtsev, S. Levendorski\v{i} //  Finance and Stochastics. -– 2009. -- Vol. 13. -– № 4. -– P.~531--562.
	\item
	\textsc{Кудрявцев, О.Е.} Вычисление цен барьерных и американских опционов в моделях Леви.-- {\em  Обозрение прикл. и промышл. матем.}, 2010, т.17, в.2, с.210-220.
	\item
	\emph{Kudryavtsev O.}  Efficient pricing of Swing options in L\'evy-driven models / O.~Kudryavtsev, A.~Zanette //Quantitative Finance. -- 2013. --V. 13. -- № 4. -- P.~~627-635.
	\item
	A. Alfonsi, High order discretization schemes for the CIR process: application
	to affine term structure and Heston models, Mathematics of Computation, 79
	(2010), 209 - 237. https://doi.org/10.1090/s0025-5718-09-02252-2
	\item
	E. Appolloni, L. Caramellino, A. Zanette, A robust tree method for pricing
	American options with CIR stochastic interest rate, 2013.
	\item
	B. Bouchard, N. El Karoui, N. Touzi, Maturity randomization for stochastic
	control problems, Ann. Appl. Probab., 15 (2005), no. 4, 2575 – 2605.
	https://doi.org/10.1214/105051605000000593
	\item
	D.M. Briani, L. Caramellino, A. Zanette, A hybrid tree-finite difference
	approach for the Heston model, 2014.
	\item 
	{\emph Cont, R.}  Financial modelling with jump processes: monograph / R. Cont, P.~Tankov. -- Chapman \& Hall/CRC Press, 2004. -- 535 p.
	\item
	P. Carr, Randomization and the American put, Review of Financial Studies,
	11 (1998), 597 - 626. https://doi.org/10.1093/rfs/11.3.597
	\item
	C. Chiarella, B. Kang, G. H. Meyer, The Evaluation of Barrier Option Prices
	Under Stochastic Volatility, Computers \& Mathematics with Applications, 64
	(2010), 2034 - 2048. https://doi.org/10.1016/j.camwa.2012.03.103
	\item
	{\emph Feng, Y. Q.} CVA under Bates Model with Stochastic Default Intensity /Y.~Q.~Feng //  Journal of Mathematical Finance. -- 2017. -- №7. -- P.~682-698.
	\item
	O. Kudryavtsev, S. Levendorskii, Fast and accurate pricing of barrier options
	under L\'evy processes, Finance and Stochastics, 13 (2009), no. 4, 531 - 562.
	\item
	O. Ye. Kudryavtsev, An efficient numerical method to solve a special cass of
	integro-differential equations relating to the Levy models, Mathematical
	Models and Computer Simulations, 3 (2011), no. 6, 706–711.
	\item
	\emph{Kudryavtsev, O.} Advantages of the Laplace transform approach in pricing first touch digital options in L\'evy-driven models / O. Kudryavtsev // J. Boletin de la Sociedad Matematica Mexicana. -- 2016. -- V.~22. -- №~2. -- P.~711--731.
	\item
	PREMIA: An Option Pricer Project CERMICS-INRIA, available at
	http://www.premia.fr
\end{enumerate}

%1.	\emph{ Кириллов, В.~И.} Логика : учебник для юрид. вузов / В.~И.~Кириллов ; Моск. гос. юрид. академия. -- 6-е изд., перераб. и доп. -- Москва~: Проспект, 2009. -- 233~с.
%
%2.	\emph{ Грушевицкая, Т.~Г.} Культурология : учебник для вузов / Т.~Г.~Грушевицкая, А.~П.~ Садохин. -- 3-е изд., перераб. и доп. -- Москва~: ЮНИТИ-ДАНА, 2008. -- 687~с.
%
%3.	Философия : учебник / Н.~С.~Савкин [и др.] ; отв. ред. Н.~С.~Савкин. -- 3-е изд., испр. -- Саранск~: Морд. ун-т, 2004. -- 355~с.
%
%4.	\emph{ Казаков, Н.~А.} Запоздалое признание : повесть / Н.~А.~Казаков // На боевом посту. -- 2000. -- № 9. -- С.~64-76.
%
%5.	\emph{ Баталов, А.~Л.} Сакральная топография средневекового города / А.~Л.~Баталов, Л.~А.~Беляев // Известия Института христианской культуры средневековья. -- Москва, 1998. -- Т. 1. -- С.~13-22.
%
%6.	\emph{ Боголюбов, А.~Н.} О вещественных резонансах в волноводе с неоднородным заполнением / А.~Н.~ Боголюбов, А.~Л.~Делицын, М.~Д.~Малых // Вестник Московского университета. Сер. 3, Физика. Астрономия. -- 2001. -- № 5. -- С.~23-25.
%
%7.	Мониторинг состояния оборудования систем связи в трубопроводном транспорте нефти / Л.~И.~ Григорьев [и др.] // Автоматизация, телемеханизация и связь в нефтяной промышленности. -- 2007. -- № 5. -- С.~3-8.
%
%8.	\emph{ Моисеева, М.~В.} Японская мультипликация и ее восприятие в России / М.~В.~Моисеева, Е.~В.~ Кудряшева // Социокультурная миссия университета в современном обществе~: сб. тр. участников I Всерос. научно-практической конф. "Человек, культура, образование" (Ульяновск, 2-4 июля 2005 г.). -- Ульяновск, 2006. -- С.~142-145.
%
%9.	Приемопередающее устройство~: пат. 2187888 Российская Федерация~: МПК H 04 В 1/38, Н 04 J 13/00 / Чугаева~В.~И.~; заявитель и патентообладатель Воронеж. науч.-ислед. ин-т связи. -- № 2000131736/09~; заявл. 18.12.00~; опубл. 20.08.02, Бюл. № 23 (II ч.). -- 3~с.
%
%10.	Пат. 2187888 Российская Федерация, МПК7 H 04 В 1/38, Н 04 J 13/00. Приемопередающее устройство / Чугаева~В.~И.~; заявитель и патентообладатель Воронеж. науч.-ислед. ин-т связи. -- № 2000131736/09~; заявл. 18.12.00~; опубл. 20.08.02, Бюл. № 23 (II ч.). -- 3~с.
%
%11.	Стекло безопасное для наземного транспорта. Общие технические условия [Текст]~: ГОСТ 5727-88. - Изд. сент. 2001 с Изм. 1, 2, 3 (ИУС. 1992. № 2; ИУС. 1999. № 1; ИУС. 2001. № 11). -- Взамен ГОСТ 5727-83~; введ. 01.01.90.
%
%12.	ГОСТ Р 517721-2001. Аппаратура радиоэлектронная бытовая. Входные и выходные параметры и типы соединений. Технические требования [Текст]. -- Введ. 2002-01-01. -- Москва~: Изд-во стандартов, 2001. -- IV, 27~с.~: ил.~; 29~см.
%
%13.	\emph{ Сидыганов, В.~У.} Модель Москвы~: электрон, карта Москвы и Подмосковья / В.~У.~Сидыганов, С.~Ю.~ Толмачев, Ю.~Э.~Цыганков. -- Версия 2.0. -- Электрон, дан. и прогр. -- Москва~: FORMOZA, 1998. -- 1 электрон. опт. диск (CD-ROM).
%
%14.	Атлас-98~: 3D., 1998. -- 1 электрон. опт. диск (CD-ROM).
%
%15.	Исследовано в России~: многопредмет. науч. журн. / Моск. физ.-техн. ин-т. -- Электрон. журн. -- Режим доступа: http://zhumal.mipt. rssi.ru
%
%16.	Электронный каталог ГПНТБ России~: база данных. -- Режим доступа: 
%
%http://www.gpntb.ru/win/search/help/el-cat.html
\section{Об авторах}
%В конце статьи необходимо указать информацию об авторах научной статьи:

%1. Ф.И.О. полностью;
%2. Ученая степень, звание (если есть);
%3. Должность (например, доцент кафедры информационных технологий)
%4. Место работы;
%5. E-mail;
%6. Контактный телефон.
1. Кудрявцев Олег Евгеньевич;
2. Доктор физико-математических наук, доцент;
3. Должность (например, Заведующий кафедры информационных таможенных технологий);
4. Ростовский филиал Российской Таможенной Академии;
5. *********@mail.ru;
6. +7(903)-999-99-99

1. Родоченко Василий Владимирович;
2. нет;
3. аспирант;
4. Южный Федеральный Университет;
5. ********************@gmail.com;
6. +7(904)-999-99-99


\end{document}
